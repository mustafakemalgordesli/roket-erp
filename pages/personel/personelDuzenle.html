<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personel Düzenle</title>
    <script src="./personelDuzenle.js"></script>
</head>

<body>
    <div class="formDiv">
        Personel Düzenle
        <hr>Düzenlenecek personelin kullanıcı adını girin<br>
        <br>
        <input list="brow" class="sec">
        <datalist id="brow">

        </datalist>
        <input type="submit" id="bilgileriGetir">
        <hr>
        <form class="center" id="ekleme-formu">
            <input type="text" id="kullanici_adi" placeholder="Kullanıcı Adı">
            <input type="text" id="bolum" placeholder="Bölüm">
            <hr>
            <input type="text" placeholder="Ad" id="ad">
            <input type="text" placeholder="Soyad" id="soyad">
            <hr>
            <input type="text" placeholder="Telefon" id="tel">
            <input type="number" placeholder="TC" id="tc">
            <hr>
            <textarea name="adres" id="adres" cols="70" rows="10">Adres...</textarea><br>
            <input type="mail" placeholder="Mail" id="mail">
            <hr>
            Medeni Durum:
            <select name="medeni_durum" id="medeni_durum">
                <option value="Evli">Evli</option>
                <option value="Bekar">Bekar</option>
                <option value="Boşanmış">Boşanmış</option>
            </select>
            <hr>
            Askerlik Durumu
            <select name="askerlik_durum" id="askerlik_durum">
                <option value="Yapıldı">Yapıldı</option>
                <option value="Tecilli">Tecilli</option>
                <option value="Muaf">Muaf</option>
            </select>
            <hr>
            <textarea name="ozel_durum" id="ozel_durum" cols="70" rows="10">Özel durum varsa buraya yazın...
        </textarea>
            <hr>Cinsiyet:
            <select name="cinsiyet" id="cinsiyet">
                <option value="Kadın">Kadın</option>
                <option value="Erkek">Erkek</option>
            </select>
            <hr>
            <input type="submit" id="kaydet" value="Kaydet"><br>
        </form>
    </div>
    <script>
        document.getElementById("kaydet").addEventListener("click", (event) => {
            event.preventDefault();
            let id = document.getElementsByClassName("sec")[0].value;
            baglanti.connection.query("UPDATE `personel` SET `ad` = '" + ad.value + "', `soyad` = '" + soyad.value + "', `tel` = '" + tel.value + "', `tc` = '" + tc.value + "', `adres` = '" + adres.value + "', `mail` = '" + mail.value + "', `kullanici_adi` = '" + kullanici_adi.value + "', `askerlik_durum` = '" + askerlik_durumu.options[askerlik_durumu.selectedIndex].value + "', `ozel_durum` = '" + ozel_durum.value + "', `cinsiyet` = '" + cinsiyet.options[cinsiyet.selectedIndex].value + "', `bolum` = '" + bolum.value + "' WHERE `personel`.`id` = " + id + ";", (err, res) => {
                if (err) throw err;
                console.log("Güncellendi")
            })
        })
        function tarihDonustur(tarih) {
            console.log(tarih);
        }
        let kullanici_adi = document.getElementById("kullanici_adi");
        let bolum = document.getElementById("bolum");
        let ad = document.getElementById("ad");
        let soyad = document.getElementById("soyad");
        let tel = document.getElementById("tel");
        let tc = document.getElementById("tc");
        let adres = document.getElementById("adres");
        let mail = document.getElementById("mail");
        let medeni_durum = document.getElementById("medeni_durum");
        let askerlik_durumu = document.getElementById("askerlik_durum");
        let ozel_durum = document.getElementById("ozel_durum");
        let cinsiyet = document.getElementById("cinsiyet");
        document.getElementById("bilgileriGetir").addEventListener("click", (event) => {
            event.preventDefault();
            let id = document.getElementsByClassName("sec")[0].value;
            baglanti.connection.query("SELECT * FROM personel WHERE id= " + id, (err, res) => {
                kullanici_adi.value = res[0]['kullanici_adi'];
                bolum.value = res[0]['bolum'];
                ad.value = res[0]['ad'];
                soyad.value = res[0]['soyad'];
                tel.value = res[0]['tel'];
                tc.value = res[0]['tc'];
                adres.value = res[0]['adres'];
                mail.value = res[0]['mail'];
                medeni_durum.value = res[0]['medeni_durum'];
                askerlik_durumu.value = res[0]['askerlik_durum']
                ozel_durum.value = res[0]['ozel_durum'];
                cinsiyet.value = res[0]['cinsiyet'];

            })

        })
        baglanti.connection.query("SELECT * FROM personel", (err, res) => {
            if (err) throw err;
            let dtList = document.getElementsByTagName("datalist")[0];
            for (i = 0; i < res.length; i++) {
                dtList.innerHTML += "<option value='" + res[i]['id'] + "'>" + res[i]['ad'] + " " + res[i]['soyad'] + "</option>";
            }
        })


    </script>
</body>

</html>